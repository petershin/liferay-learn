# 워크플로 지표 사용

{bdg-primary}`구독`

```{warning}
이 기능은 [Elasticsearch에서만](../../../using-search/installing-and-upgrading-a-search-engine/solr/solr-limitations.md) 작동합니다.
```

**Workflow Metrics** 은 특정 워크플로 이벤트를 완료하는 데 소요된 시간에 대한 통찰력을 제공합니다. 이를 사용하려면 워크플로 프로세스의 이벤트에 대한 기한을 설정하십시오. 이러한 기한 구성을 SLA(서비스 수준 계약)라고 합니다. 일단 정의되면 워크플로 보고서는 SLA 준수 여부를 측정합니다. 워크플로 참가자와 워크플로 항목을 제출하는 사용자 간의 계약과 같습니다. **워크플로 보고서** 은 각 워크플로 항목의 SLA 상태(제시 또는 기한 초과)를 포함하여 SLA가 있는 모든 프로세스에 대한 데이터를 보여줍니다.

```{important}
* *SLA가 있는 워크플로 편집:* SLA가 정의된 워크플로를 편집(예: 노드 제거, 작업 이름 편집)하면 워크플로/SLA 파이프라인에 이미 있는 항목에 대한 SLA가 무효화될 수 있습니다.

* *활성 프로세스에 대한 SLA 만들기 또는 편집:* 항목이 이미 워크플로 프로세스에 있는 동안 SLA 기간을 편집하거나 새 SLA를 정의하면 현재 워크플로에 있는 모든 인스턴스가 다시 계산됩니다. 완료된 워크플로 인스턴스는 다시 계산되지 않습니다.
```

## 전제 조건

**Workflow Metrics** 사용하려면 Elasticsearch를 사용하여 DXP 데이터를 인덱싱해야 합니다. 자세히 알아보려면 [Elasticsearch 설치](../../../using-search/installing-and-upgrading-a-search-engine/elasticsearch/installing-elasticsearch.md) 기사를 읽어보세요.

## SLA 추가

SLA를 추가하려면

1. 글로벌 메뉴에서 **애플리케이션** &rarr; **워크플로** &rarr; **메트릭** 로 이동합니다.
1. 프로세스의 제목을 클릭합니다.
1. 프로세스에 대한 SLA가 없는 경우 많은 양을 알리는 경고 메시지가 나타납니다. 새 SLA 양식에 직접 액세스하려면 경고에서 **새 SLA 추가** 링크를 클릭하십시오.

   또는 옵션(![Options](../../../images/icon-options.png)) 메뉴를 클릭하고 **SLA 설정** 선택합니다.

   ![메트릭 애플리케이션에서 워크플로 정의에 SLA를 추가합니다.](./using-workflow-metrics/images/01.png)

1. SLA 화면에서 **추가** 버튼(![Add](../../../images/icon-add.png))을 클릭합니다.
1. 새 SLA 양식에서 SLA에 이름과 설명을 지정합니다.
1. 다음 세 가지를 지정하여 SLA의 기간을 정의합니다.

    * **시작** : 작업 시작: 검토
    * **일시 중지** : 작업 중: 업데이트
    * **중지** : 프로세스 종료: 승인됨

1. SLA의 기간(예: 기한)을 정의합니다. 두 개의 시간 상자 중 하나 이상을 작성하십시오.

    * **일:** 1
    * **시간:** 00:00

    ![SLA 예](./using-workflow-metrics/images/03.png)

1. **저장** 클릭합니다.

![SLA 화면에서 SLA를 관리합니다.](./using-workflow-metrics/images/02.png)

### 유효한 시작 및 중지 이벤트

모든 워크플로우 작업은 SLA의 시작 또는 종료 매개변수로 사용할 수 있습니다.

항목이 여기에 정의된 이벤트에 도달하면 SLA 타이머가 계산을 시작합니다. 다음 옵션 중에서 선택합니다.

| 이벤트 시작  | 묘사                                                                     |
|:------- |:---------------------------------------------------------------------- |
| 시작 노드   | SLA 타이머는 **생성** 노드를 입력하면 시작됩니다.                                          |
| 작업 시작   | SLA 시계는 워크플로가 작업으로 전환될 때 시작됩니다.                                        |
| 작업에서 종료 | SLA 시계는 작업 흐름이 작업 밖으로 전환될 때 시작됩니다. 예를 들어 **검토** 작업을 떠날 때 SLA 타이머가 시작됩니다. |

항목이 정의된 SLA 기간(마감일) 이전에 중지 이벤트에 도달하면 SLA에 따라 **On Time** 입니다. 지정된 기간 내에 Stop 이벤트에 도달하지 못하면 **Overdue** 입니다. SLA의 중지 이벤트 역할을 할 작업을 정의할 때 다음 옵션 중에서 선택하십시오.

| 중지 이벤트  | 묘사                                           |
|:------- |:-------------------------------------------- |
| 작업 시작   | 워크플로가 작업(예: **업데이트** 작업)으로 전환되면 SLA 시계가 중지됩니다. |
| 작업에서 종료 | SLA 시계는 워크플로가 작업에서 전환되면 중지됩니다(예: **검토** 작업).   |
| 끝 노드    | **승인** 노드에 진입하면 SLA 타이머가 중지됩니다.                |

일시 중지 필드는 시간 계산을 중지해야 하는 워크플로의 이벤트를 정의합니다. 단일 승인자 워크플로의 경우 항목이 업데이트 작업에 있을 때 SLA 타이머를 일시 중지하도록 선택할 수 있습니다. SLA는 시작 노드와 끝 노드 사이에 있는 모든 작업에서 일시 중지할 수 있으며 SLA를 일시 중지해야 하는 노드를 설정하여 정의합니다. **SLA 타이머는 워크플로 항목이 지정된 노드** 에 있는 전체 시간 동안 일시 중지됩니다.

### 기간

| 시간 단위 | 지침                                                                               |
|:----- |:-------------------------------------------------------------------------------- |
| 일     | 일 수는 정수를 입력하십시오. 36시간과 같이 부분적인 날짜가 있는 경우 **시간** 필드와 조합하여 사용합니다. 1일 12시간으로 표현합니다.   |
| 시간    | 시간과 분을 입력합니다. **시간** 상자의 값은 **23:59** 초과하지 않아야 합니다. 기간이 1일을 초과하는 경우 **일** 필드와 함께 사용합니다. |

## SLA 작업 간격 구성

메트릭 재계산 사이의 시간 간격을 **SLA 작업 간격** 이라고 합니다. 기본값은 1분입니다. 변경하려면

1. 애플리케이션 메뉴(![Applications Menu](../../../images/icon-applications-menu.png))에서 시스템 설정 애플리케이션으로 이동하여 워크플로 메트릭 항목을 엽니다.

2. SLA 작업 간격 확인 구성 값을 변경하고 **저장** 클릭합니다.

또는

1. 라는 구성 파일을 만듭니다.

   ```
   com.liferay.portal.workflow.metrics.internal.configuration.WorkflowMetricsConfiguration.config
   ```

2. 다음과 같은 내용을 제공하십시오.

   ```properties
   checkSLAJobInterval="1"
   ```

3. `[Liferay Home]/osgi/configs`에 배치합니다.

Workflow Metrics 데이터는 검색 엔진에서 읽어 메트릭을 계산합니다. 간격 값을 구성할 때 다음과 같은 경쟁 성능 문제를 고려하십시오.

- 메트릭 재계산 이벤트 사이의 긴 시간은 재계산할 때마다 더 많은 검색 문서를 읽는 것과 일치합니다.
- 메트릭 재계산 이벤트 사이의 짧은 시간은 검색 엔진에 대한 읽기 요청 빈도가 더 높은 것과 일치합니다.

## 워크플로우 메트릭 재인덱싱

Liferay DXP의 **Reindex** 작업은 매핑 파일을 기반으로 검색 색인을 완전히 삭제한 다음 다시 생성합니다. 메트릭도 데이터베이스에 저장되기 때문에 다시 인덱싱할 때 데이터가 손실될 위험이 없습니다. Liferay 7.3에서 워크플로우 메트릭을 다시 인덱싱하려면,

1. 메트릭 애플리케이션에서 옵션 메뉴(![Options](../../../images/icon-options.png))를 열고 **설정** 클릭합니다.

2. 이제 Workflow Index Actions 화면에서 Workflow Indexes 항목에 대해 **Reindex All** 클릭합니다.

   이 옵션은 Workflow Metrics 애플리케이션의 모든 인덱스에 적용됩니다. 보다 세분화된 옵션도 사용할 수 있습니다. 가상 인스턴스가 여러 개 있는 경우 각 인스턴스의 워크플로 메트릭을 개별적으로 다시 인덱싱해야 합니다.

Liferay 7.2에서 Workflow Metrics는 검색 관리 패널(제어판 &rarr; 구성 &rarr; 검색)에서 다시 인덱싱됩니다.

[검색 엔진](../../../using-search/installing-and-upgrading-a-search-engine/installing-a-search-engine.md) 이 처음 구성되고 업그레이드될 때마다 Workflow Metrics의 재인덱싱이 필요합니다. 좋은 경험 법칙은 Liferay DXP의 기본 검색 인덱스가 다시 인덱싱될 때마다 Workflow Metrics를 다시 인덱싱해야 한다는 것입니다.

워크플로 프로세스의 전체 메트릭에서 워크플로의 단일 항목에 대한 세부 정보에 이르기까지 새로운 워크플로 메트릭 기능은 Liferay DXP에서 **일을 완료** 하는 데 걸리는 시간에 대한 통찰력을 제공합니다.

## 대량으로 워크플로 작업 관리

메트릭 UI 내에서 워크플로 작업을 대량으로 관리할 수 있습니다. 예를 들어 각 작업으로 개별적으로 이동하지 않고 단일 사용자에게 여러 작업을 할당할 수 있습니다. 이 기능을 탐색하려면 워크플로 프로세스 내에서 관리해야 하는 일부 항목이 있는지 확인하십시오. 예를 들어, [블로그에 대한 단일 승인자 워크플로 프로세스를 활성화](./activating-workflow.md) 한 다음 몇 개의 블로그를 워크플로에 제출합니다.

1. 메트릭 애플리케이션에서 워크플로 프로세스(예: 단일 승인자)를 클릭하여 대시보드 보기를 엽니다.
1. **Total Pending** 상자 위로 마우스를 이동하고 **See Items** 클릭하여 Pending 상태의 보류 중인 워크플로 항목 테이블을 엽니다.
1. 워크플로에서 재할당할 항목을 선택하고 재할당 버튼(![Reassign](../../../images/icon-move.png))을 클릭합니다.

   ![한 번에 여러 워크플로 작업을 재할당합니다.](./using-workflow-metrics/images/04.png)
1. 재할당할 작업 선택 모달에서 작업을 다시 선택하고 **다음** 클릭합니다.
1. 모든 작업을 동일한 할당자에게 할당하려면 확인란을 선택합니다. **모든 작업에 동일한 할당자 사용.** , 담당자를 검색합니다.

   각 작업에 대해 담당자를 수동으로 선택하려면 각 항목의 새 담당자 상자를 사용하여 담당자를 선택하십시오.

   ![각 워크플로 작업의 담당자를 선택하거나 모든 작업에 동일한 담당자를 사용합니다.](./using-workflow-metrics/images/05.png)

1. 재할당을 클릭합니다.

유사한 일련의 단계에 따라 선택한 워크플로 항목의 기한(![Calendar](../../../images/icon-calendar.png))을 업데이트하거나 워크플로의 다른 단계로 전환(![Transition](../../../images/icon-transition-arrow.png))할 수도 있습니다.

![여러 워크플로 항목을 한 번에 워크플로의 새 단계로 전환합니다.](./using-workflow-metrics/images/06.png)

## 관련 주제

* [워크플로우 디자이너에서 태스크 생성](https://help.liferay.com/hc/articles/360028821932-Creating-Tasks-in-the-Workflow-Designer)
* [워크플로 태스크 노드](../developer-guide/workflow-task-node-reference.md)
