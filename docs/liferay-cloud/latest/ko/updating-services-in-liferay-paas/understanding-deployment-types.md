# 배포 유형 이해

서비스의 배포 유형에 따라 성능, 메모리 사용량, 파일이나 볼륨에 대한 액세스 등 서비스 작동 방식의 다양한 측면이 결정됩니다. Liferay Cloud는 해당 서비스에 `배포`와 `StatefulSet`라는 두 가지 배포 유형을 제공합니다.

## 배포 유형 간의 차이점

**배포** 유형의 특징은 다음과 같습니다.

* NFS(네트워크 파일 시스템)는 이 서비스에 사용 가능한 디렉터리에 마운트됩니다.
* 네트워크 식별자는 무작위입니다(예: `liferay-89f9f559`, `liferay-d1267401`)
* 배포 및 확장이 순서대로 이루어지지 않음
* 자동 롤링 업데이트는 순서가 지정되지 않습니다.

한편 **StatefulSet** 유형의 특징은 다음과 같습니다.

* 서비스에는 전용 SSD가 할당됩니다.
* 네트워크 식별자는 안정적이고 고유합니다(예: `search-0`, `search-1`).
* 배포 및 확장이 순서대로 이루어집니다.
* 자동 롤링 업데이트가 주문됩니다.

| **유형** | **목적** | **리소스 사용량 및 시작 시간** | **로컬 볼륨 전용 SSD** | **NFS에 대한 액세스** | **순서에 따른 시작/확장** |
| :-------------- | :---------------------- | :--------------------------------------------- | :--------------: | :-------------: | :--------------: |
| **전개** | NFS를 사용하는 상태 비저장 애플리케이션 | `StatefulSet` 유형보다 더 적은 리소스를 소비하고 더 빠르게 시작됩니다. |        엑스        |        ✓        |        엑스        |
| **StatefulSet** | 상태 저장 애플리케이션            | `배포` 유형보다 더 많은 리소스를 소비하고 시작 속도가 느립니다.          |         ✓        |      ✓[^1]      |         ✓        |

[^1]: `StatefulSets`는 NFS 볼륨을 사용할 수 있지만 Liferay의 홈 디렉터리에 사용되는 것과 동일한 전용 볼륨을 사용할 수는 없습니다.

일반적으로 `배포` 유형은 더 가볍고 더 빠른 배포는 물론 서비스 간 공유 볼륨(문서 라이브러리와 같은 공유 파일의 경우)도 허용합니다. `StatefulSet` 유형은 배포 및 리소스 사용(프로젝트에 할당된 총 메모리 및 CPU 포함) 비용이 더 많이 들지만 배포를 통해 데이터를 유지하고 전용 SSD를 사용하여 향상된 파일 액세스 성능을 얻습니다.

### 공유 볼륨(NFS)과 SSD 스토리지

NFS(네트워크 파일 시스템)는 모든 `배포` 유형 서비스에서 사용할 수 있습니다. NFS는 서비스가 재배포되거나 삭제되는지 여부에 관계없이 유지됩니다.

NFS에 저장된 볼륨은 모든 `배포` 유형 서비스에서도 사용할 수 있습니다. NFS는 `Liferay` 및 `Backup` 서비스에 기본적으로 사용되어 문서 라이브러리에 대한 액세스를 공유합니다. NFS용 볼륨 구성에 대한 자세한 내용은 [영구 파일 시스템 볼륨 구성](./configuring-persistent-file-storage-volumes.md) 참조하세요.

`StatefulSet` 유형 서비스에는 모든 볼륨 스토리지를 위한 전용 SSD가 있습니다. `StatefulSet` 유형 서비스에서 사용할 수 있는 전용 SSD는 다른 서비스에서 접근할 수 없습니다. SSD에 저장된 볼륨은 재배포 시와 서비스 삭제 후에도 유지됩니다. 클러스터된 `StatefulSet` 서비스에서는 각 인스턴스의 볼륨이 다릅니다.

## Liferay Cloud 서비스 구성 방법

다음은 Liferay Cloud의 서비스가 기본적으로 사전 구성되는 방법을 자세히 설명합니다.

* **Liferay** 및 **Backup** 서비스는 **배포** 유형을 사용하므로 NFS에 저장된 문서 라이브러리에 대한 액세스를 공유할 수 있습니다.

* **Database** 및 **Web Server** 서비스도 **배포** 유형을 사용하므로 경량 상태를 유지하고 빠르게 시작할 수 있습니다.

* **CI** 서비스는 **StatefulSet** 유형을 사용하므로 전용 SSD를 보유함으로써 추가 파일 액세스 속도를 활용할 수 있습니다.

* **Search** 서비스도 **StatefulSet** 유형을 사용하므로 검색 속도를 높일 수 있고 서비스가 다시 시작되더라도 SSD에 저장된 검색 색인이 손실되지 않습니다.

## 배포 유형 구성

기본적으로 Liferay Cloud의 서비스는 대부분의 사용 사례에 맞게 사전 구성되어 있습니다. 그러나 각 서비스의 배포 유형은 서비스의 `LCP.json`에 있는 `kind` 변수를 통해 구성할 수 있습니다.

```json
{
    "id": "search",
    "kind": "StatefulSet"
}
```

!!! note
    배포 유형을 변경하면 데이터가 손실되거나 성능에 영향을 미칠 수 있으므로 주의해서 변경하세요.

## 관련 주제

* [영구 파일 시스템 볼륨 구성](./configuring-persistent-file-storage-volumes.md)
* [배포 전략 이해](./understanding-deployment-strategies.md)
